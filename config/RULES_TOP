#
#  $Id$
#

include $(TOP)/config/RULES_DIRS

uninstall$(DIVIDER)%::
	@$(RMDIR) $(INSTALL_LOCATION_BIN)/$* $(INSTALL_LOCATION_LIB)/$* \
		$(INSTALL_LOCATION)/dbd $(INSTALL_MAN) $(INSTALL_INCLUDE) \
		$(INSTALL_DOC) $(INSTALL_DBD)
	@$(RMDIR)  rec.bak rec

uninstall:: $(addprefix uninstall$(DIVIDER),$(BUILD_ARCHS))

tar:
	@DIRNAME=$(notdir $(shell pwd)); \
	echo "TOP: Creating $$DIRNAME.Tar file..."; \
	ls Makefile* | xargs tar vcf $$DIRNAME.Tar; \
	if [ -f .current_rel_hist ]; then \
		ls .current_rel_hist | xargs tar vrf $$DIRNAME.Tar ; \
	fi ;\
	if [ -f EPICS_BASE ]; then \
		ls EPICS_BASE | xargs tar vrf $$DIRNAME.Tar ; \
	fi ;\
	for DIR in ${DIRS}; do    \
		find $${DIR} -name CVS -prune -o ! -type d -print \
		| grep -v "/O\..*$$" | xargs tar vrf $$DIRNAME.Tar; \
	done

help:
	@echo "Usage: gnumake [options] [target] ..."
	@echo "Targets supported by all Makefiles:"
	@echo "     install		- Installs executables in bin/<arch> (default rule)"
	@echo "     build		- Builds objects, using libraries from "build_libs"
	@echo "     clean		- Cleans objects.  Clean removes the" O.<arch> dirs
	@echo "                   in all except the O.<arch> level Makefile"
	@echo "     depends		- Generates include dependencies"
	@echo "\"Partial\" build targets supported by Makefiles:"
	@echo "     install.<arch> - Builds and installs <arch> only.
	@echo "     clean.<arch>   - Cleans <arch> binaries in O.<arch> dirs only."
	@echo "     build.<arch>   - Builds <arch> only.
	@echo "     depends.<arch> - Generates <arch> dependencies only.
	@echo "Targets supported by top level Makefile:"
	@echo "     uninstall   - Cleans directories created by the install."
	@echo "     tar         - Create tar file "
	@echo "Indiv. object targets are supported by O.<arch> level Makefile .e.g"
	@echo "     xxxRecord.o 

.PHONY :: uninstall tar help
.PHONY :: $(addprefix uninstall$(DIVIDER), $(BUILDARCHS))

