#
# $Id$
#

ifndef T_A

all: install

rebuild: clean all

ACTIONS += inc
ACTIONS += build
ACTIONS += install
ACTIONS += buildInstall 
ACTIONS += depends 
ACTIONS += rebuild 

actionPart = $(word 1, $(subst $(DIVIDER), ,$@))
archPart = $(word 2, $(subst $(DIVIDER), ,$@))

actionArchTargets = $(foreach x, $(ACTIONS),\
		$(foreach arch,$(BUILD_ARCHS), $(x)$(DIVIDER)$(arch)))


$(actionArchTargets) : 
	$(MAKE) -f Makefile T_A=$(archPart) $(actionPart)

$(BUILD_ARCHS) : % : 
	$(MAKE) -f Makefile T_A=$@

$(ACTIONS):%: $(foreach arch, $(BUILD_ARCHS), %$(DIVIDER)$(arch))

#
# special clean rule
#
clean ::
	$(RMDIR) $(addsuffix *,$(addprefix O.,$(BUILD_ARCHS)))

clean$(DIVIDER)% :: 
	$(RMDIR) O.$**

.PHONY : $(buildActionTargets)
.PHONY : $(buildActionArchTargets)
.PHONY : $(buildArchs)
.PHONY : $(ACTIONS) clean all

else  #T_A
ifndef B_T
include $(CONFIG)/RULES_BUILD_TYPE
endif
endif
